<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Dashboard – PermitBot Pro</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="description" content="Manage permit packets with PermitBot Pro." />
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-slate-950 text-slate-50 antialiased">
  <div class="min-h-screen flex flex-col">
    <!-- Header -->
    <header class="border-b border-slate-800 bg-slate-950/90">
      <div class="max-w-5xl mx-auto px-4 h-16 flex items-center justify-between">
        <a href="index.html" class="flex items-center gap-2">
          <div class="h-9 w-9 rounded-2xl bg-emerald-400 flex items-center justify-center font-bold text-slate-950 text-lg">
            PB
          </div>
          <div class="flex flex-col leading-tight">
            <span class="font-semibold text-sm tracking-tight">PermitBot Pro</span>
            <span class="text-[11px] text-slate-400 uppercase tracking-[0.15em]">Permit Dashboard</span>
          </div>
        </a>
        <div class="flex items-center gap-3 text-xs">
          <span class="hidden sm:inline text-slate-400">Early access workspace</span>
          <a href="login.html" class="rounded-full border border-slate-700 px-3 py-1.5 text-slate-200 hover:border-emerald-400/70">
            Log out
          </a>
        </div>
      </div>
    </header>

    <!-- Main -->
    <main class="flex-1">
      <div class="max-w-5xl mx-auto px-4 py-8 space-y-8">
        <!-- Intro -->
        <section>
          <h1 class="text-2xl font-semibold text-white">Dashboard</h1>
          <p class="mt-1 text-sm text-slate-300 max-w-xl">
            Use this early access dashboard to ask AI which permits/forms you likely need for a job.
            Later, this will tie into auto-filled PDFs and saved projects.
          </p>
        </section>

        <!-- Ask AI section -->
        <section class="max-w-3xl space-y-3">
          <h2 class="text-lg font-semibold text-white">Ask AI for permit suggestions</h2>
          <p class="text-xs text-slate-300">
            Fill this out like you’re emailing your office admin or EIT. Jurisdiction and project type are required.
          </p>

          <div class="space-y-2 text-sm rounded-2xl border border-slate-800 bg-slate-900/80 p-4">
            <div class="grid sm:grid-cols-2 gap-3">
              <div>
                <label class="block text-xs text-slate-200 mb-1">Jurisdiction *</label>
                <input id="ai-jurisdiction"
                  class="w-full rounded-lg border border-slate-700 bg-slate-950 px-3 py-2 text-slate-100"
                  placeholder="Palm Coast, Volusia County, Daytona Beach..." />
              </div>
              <div>
                <label class="block text-xs text-slate-200 mb-1">Project type *</label>
                <input id="ai-project-type"
                  class="w-full rounded-lg border border-slate-700 bg-slate-950 px-3 py-2 text-slate-100"
                  placeholder="SFR – New build, pool, TI, etc." />
              </div>
            </div>

            <div>
              <label class="block text-xs text-slate-200 mb-1">Parcel or address (optional)</label>
              <input id="ai-parcel"
                class="w-full rounded-lg border border-slate-700 bg-slate-950 px-3 py-2 text-slate-100"
                placeholder="25 Pine Grove Dr, Palm Coast, FL or parcel ID" />
            </div>

            <div>
              <label class="block text-xs text-slate-200 mb-1">What forms do you think you need? (optional)</label>
              <textarea id="ai-forms-expected" rows="2"
                class="w-full rounded-lg border border-slate-700 bg-slate-950 px-3 py-2 text-slate-100"
                placeholder="Building permit, utility app, FDEP potable/sewer, stormwater checklist, ROW…"></textarea>
            </div>

            <div>
              <label class="block text-xs text-slate-200 mb-1">Extra context (optional)</label>
              <textarea id="ai-extra" rows="3"
                class="w-full rounded-lg border border-slate-700 bg-slate-950 px-3 py-2 text-slate-100"
                placeholder="City water/sewer or well/septic, flood zone, special conditions, etc."></textarea>
            </div>

            <button
              onclick="runPermitAI()"
              class="mt-2 rounded-full bg-emerald-400 px-4 py-2 text-sm font-semibold text-slate-950 hover:bg-emerald-300">
              Ask AI
            </button>
            <p class="text-[11px] text-slate-500">
              This calls your /api/ai-permit-suggest endpoint using your OpenAI key on Vercel.
            </p>
          </div>

          <!-- Output -->
          <div class="rounded-2xl border border-slate-800 bg-slate-900/80 p-4">
            <h3 class="text-sm font-semibold text-white mb-1">AI output</h3>
            <pre id="ai-output" class="text-xs text-slate-300 whitespace-pre-wrap">
Fill out the fields above and click “Ask AI” to see suggested forms here.
            </pre>
          </div>
        </section>
      </div>
    </main>

    <!-- Footer -->
    <footer class="border-t border-slate-800">
      <div class="max-w-5xl mx-auto px-4 py-4 flex flex-col sm:flex-row items-center justify-between gap-2 text-[11px] text-slate-500">
        <span>© <span id="year"></span> PermitBot Pro.</span>
        <span>Early access dashboard.</span>
      </div>
    </footer>
  </div>

  <script>
    document.getElementById("year").textContent = new Date().getFullYear();

    async function runPermitAI() {
      const payload = {
        parcel_or_address: document.getElementById("ai-parcel").value,
        jurisdiction: document.getElementById("ai-jurisdiction").value,
        project_type: document.getElementById("ai-project-type").value,
        forms_expected: document.getElementById("ai-forms-expected").value,
        extra_context: document.getElementById("ai-extra").value
      };

      const out = document.getElementById("ai-output");

      if (!payload.jurisdiction || !payload.project_type) {
        out.textContent = "Please fill at least jurisdiction and project type.";
        return;
      }

      out.textContent = "Thinking…";

      try {
        const res = await fetch("/api/ai-permit-suggest", {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify(payload)
        });

        const data = await res.json();
        out.textContent = JSON.stringify(data, null, 2);
      } catch (err) {
        out.textContent = "Error talking to AI: " + err.message;
      }
    }
  </script>
</body>
</html>
